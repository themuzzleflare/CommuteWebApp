(this.webpackJsonpcommute=this.webpackJsonpcommute||[]).push([[0],{120:function(e,t){},122:function(e,t){},132:function(e,t){},134:function(e,t){},161:function(e,t){},162:function(e,t){},167:function(e,t){},169:function(e,t){},176:function(e,t){},195:function(e,t){},212:function(e,t,n){"use strict";n.r(t);var a=n(7),o=n.n(a),i=n(3),r=n.n(i),s=(n(28),n(0));var d=function(){return Object(s.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:Object(s.jsxs)("div",{className:"container-fluid",children:[Object(s.jsxs)("a",{className:"navbar-brand hstack gap-2",href:"index.html",children:[Object(s.jsx)("img",{className:"d-inline-block align-text-center rounded-3",alt:"Commute",width:"50",height:"50",src:"images/logo.png"}),"Commute"]}),Object(s.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarContent","aria-controls":"navbarContent","aria-expanded":"false","aria-label":"Toggle Navigation",children:Object(s.jsx)("span",{className:"navbar-toggler-icon"})}),Object(s.jsxs)("div",{id:"navbarContent",className:"collapse navbar-collapse",children:[Object(s.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(s.jsx)("li",{className:"nav-item",children:Object(s.jsx)("a",{className:"nav-link active","aria-current":"page",href:"index.html",children:"Trips"})}),Object(s.jsx)("li",{className:"nav-item",children:Object(s.jsx)("a",{className:"nav-link",href:"stations.html",children:"Stations"})}),Object(s.jsx)("li",{className:"nav-item",children:Object(s.jsx)("a",{className:"nav-link",href:"tools.html",children:"Tools"})}),Object(s.jsx)("li",{className:"nav-item",children:Object(s.jsx)("a",{className:"nav-link",href:"about.html",children:"About"})})]}),Object(s.jsxs)("div",{className:"d-flex",children:[Object(s.jsx)("div",{id:"apple-sign-in-button"}),Object(s.jsx)("div",{id:"apple-sign-out-button"})]}),Object(s.jsx)("div",{id:"username"})]})]})})};var l=function(){return Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{id:"alertPlaceholder"}),Object(s.jsx)("div",{id:"searchBar"}),Object(s.jsx)("div",{id:"trips"}),Object(s.jsx)("div",{id:"spinner"}),Object(s.jsx)("div",{id:"toastPlaceholder",className:"position-absolute bottom-0 end-0 p-3"})]})};var c=function(){return Object(s.jsxs)("div",{children:[Object(s.jsx)(d,{}),Object(s.jsx)(l,{})]})},u=n(12),m=n(215);var b=function(e){var t,n,a,o,i=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div"),l=document.createElement("h5"),c=document.createElement("button"),b=document.createElement("div"),v=document.createElement("p"),p=document.createElement("div"),f=document.createElement("button");return i.id=null!==(t=null===e||void 0===e?void 0:e.uuid)&&void 0!==t?t:Object(m.a)(),i.classList.add("modal"),i.classList.add("fade"),i.setAttribute("tabindex","-1"),i.setAttribute("aria-labelledby","label-"+i.id),i.setAttribute("aria-hidden","true"),r.className="modal-dialog",s.className="modal-content",d.className="modal-header",l.id="label-"+i.id,l.className="modal-title",l.innerText=null!==(n=null===e||void 0===e?void 0:e.ckErrorCode)&&void 0!==n?n:"Error",c.className="btn-close",c.setAttribute("type","button"),c.setAttribute("data-bs-dismiss","modal"),c.setAttribute("aria-label","Close"),b.className="modal-body",v.innerText=null!==(a=null!==(o=null===e||void 0===e?void 0:e.reason)&&void 0!==o?o:null===e||void 0===e?void 0:e.message)&&void 0!==a?a:"An unknown error occurred.",p.className="modal-footer",f.classList.add("btn"),f.classList.add("btn-secondary"),f.setAttribute("type","button"),f.setAttribute("data-bs-dismiss","modal"),f.textContent="Close",p.append(f),b.append(v),d.append(l,c),s.append(d,b,p),r.append(s),i.append(r),new u.a(i)};var v=function(e){var t=Object(s.jsx)("div",{className:"toast-body",children:"A change has been made to your saved trips from another device. Please refresh."},e.notificationID+"-bodyKey"),n=Object(s.jsx)("strong",{className:"me-auto",children:"Change made to Trips"},e.notificationID+"-titleKey"),a=Object(s.jsx)("button",{className:"btn-close",type:"button","data-bs-dismiss":"toast","aria-label":"Close"},e.notificationID+"-closeButtonKey"),o=Object(s.jsx)("div",{className:"toast-header",children:[n,a]},e.notificationID+"-headerKey"),i=Object(s.jsx)("div",{id:"tripsChangeNotification",className:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true",children:[o,t]});r.a.render(i,document.getElementById("toastPlaceholder"));var d=document.getElementById("tripsChangeNotification");return d.addEventListener("hidden.bs.toast",(function(){r.a.unmountComponentAtNode(document.getElementById("toastPlaceholder"))})),new u.b(d)},p=n(110),f={containers:[{containerIdentifier:"iCloud.cloud.tavitian.commute",environment:"production",apnsEnvironment:"production",apiTokenAuth:{apiToken:"4ff6e686d07f5c352890701bcff389ed23a506ddfc27a57b8cb8118f16f82ba4",persist:!0,signInButton:{id:"apple-sign-in-button",theme:"white-with-outline"},signOutButton:{id:"apple-sign-out-button",theme:"white-with-outline"}}}],services:{logger:console}},h=p.configure(f);var j=function(){var e,t=document.getElementById("tripsSearch").value.toUpperCase(),n=document.getElementById("tripsList").getElementsByTagName("li");for(e=0;e<n.length;e++)(n[e].textContent||n[e].innerText).toUpperCase().indexOf(t)>-1?n[e].style.display="":n[e].style.display="none"};var g=function(e){if(e){var t=Object(s.jsx)("span",{className:"visually-hidden",children:"Loading..."}),n=Object(s.jsx)("div",{className:"spinner-border m-5",role:"status",children:t}),a=Object(s.jsx)("div",{className:"d-flex justify-content-center",children:n});r.a.render(a,document.getElementById("spinner"))}else r.a.unmountComponentAtNode(document.getElementById("spinner"))};var y=function(e){var t=e.fields.CD_fromName.value.split(" Station").join("")+" to "+e.fields.CD_toName.value.split(" Station").join("");return Object(s.jsx)("li",{id:e.fields.CD_id.value,className:"list-group-item",children:t},e.recordName)};var N=function(e){var t=e.map((function(e){return y(e)})),n=Object(s.jsx)("ul",{id:"tripsList",className:"list-group list-group-flush",children:t});r.a.render(n,document.getElementById("trips"))};var x=function(e){var t,n,a,o=null!==(t=null!==(n=null===e||void 0===e?void 0:e.reason)&&void 0!==n?n:null===e||void 0===e?void 0:e.message)&&void 0!==t?t:"An unknown error occurred.",i=Object(s.jsx)("button",{className:"btn-close",type:"button","data-bs-dismiss":"alert","aria-label":"Close"},"closeButtonKey"),d=Object(s.jsx)("p",{className:"mb-0",children:o},"messageKey"),l=Object(s.jsx)("h5",{className:"alert-heading",children:null!==(a=null===e||void 0===e?void 0:e.ckErrorCode)&&void 0!==a?a:"Error"},"headingKey"),c=Object(s.jsx)("div",{className:"alert alert-danger alert-dismissible fade show m-2",role:"alert",children:[l,d,i]});r.a.render(c,document.getElementById("alertPlaceholder"))};var E=function(){var e=h.getDefaultContainer().privateCloudDatabase;g(!0),K(!1),e.performQuery({recordType:"CD_Trip",sortBy:[{fieldName:"CD_dateAdded",ascending:!1},{fieldName:"CD_fromName",ascending:!0},{fieldName:"CD_toName",ascending:!0}]},{zoneID:{zoneName:"com.apple.coredata.cloudkit.zone"},resultsLimit:200,desiredKeys:["CD_id","CD_fromId","CD_fromStopId","CD_fromName","CD_toId","CD_toStopId","CD_toName","CD_dateAdded"],numbersAsStrings:!1}).then((function(e){if(e.hasErrors)throw e.errors[0];N(e.records),g(!1),K(!0)})).catch((function(e){g(!1),K(!1),x(e),C(e).show()}))};var C=function(e){var t,n,a,o,i=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div"),l=document.createElement("h5"),c=document.createElement("button"),b=document.createElement("div"),v=document.createElement("p"),p=document.createElement("div"),f=document.createElement("button"),h=document.createElement("button");return i.id=null!==(t=null===e||void 0===e?void 0:e.uuid)&&void 0!==t?t:Object(m.a)(),i.classList.add("modal"),i.classList.add("fade"),i.setAttribute("tabindex","-1"),i.setAttribute("aria-labelledby","label-"+i.id),i.setAttribute("aria-hidden","true"),r.className="modal-dialog",s.className="modal-content",d.className="modal-header",l.id="label-"+i.id,l.className="modal-title",l.innerText=null!==(n=null===e||void 0===e?void 0:e.ckErrorCode)&&void 0!==n?n:"Error",c.className="btn-close",c.setAttribute("type","button"),c.setAttribute("data-bs-dismiss","modal"),c.setAttribute("aria-label","Close"),b.className="modal-body",v.innerText=null!==(a=null!==(o=null===e||void 0===e?void 0:e.reason)&&void 0!==o?o:null===e||void 0===e?void 0:e.message)&&void 0!==a?a:"An unknown error occured.",p.className="modal-footer",f.classList.add("btn"),f.classList.add("btn-secondary"),f.setAttribute("type","button"),f.setAttribute("data-bs-dismiss","modal"),f.textContent="Close",h.classList.add("btn"),h.classList.add("btn-primary"),h.setAttribute("type","button"),h.setAttribute("data-bs-dismiss","modal"),h.onclick=function(){return E()},h.textContent="Retry",p.append(f,h),b.append(v),d.append(l,c),s.append(d,b,p),r.append(s),i.append(r),new u.a(i)};var O=function(){var e=h.getDefaultContainer().privateCloudDatabase,t=document.getElementById("fromStationDataList"),n=document.getElementById("toStationDataList"),a="div[id='fromStation'] datalist[id='fromStationOptions'] option[value='"+t.value+"']",o="div[id='toStation'] datalist[id='toStationOptions'] option[value='"+n.value+"']",i=document.querySelector(a),r=document.querySelector(o),s={recordType:"CD_Trip",fields:{CD_entityName:{type:"STRING",value:"Trip"},CD_id:{type:"STRING",value:Object(m.a)().toUpperCase()},CD_fromId:{type:"STRING",value:i.id},CD_fromStopId:{type:"STRING",value:i.getAttribute("stopid")},CD_fromName:{type:"STRING",value:i.getAttribute("value")},CD_toId:{type:"STRING",value:r.id},CD_toStopId:{type:"STRING",value:r.getAttribute("stopid")},CD_toName:{type:"STRING",value:r.getAttribute("value")},CD_dateAdded:{type:"TIMESTAMP",value:Date.now()}}};e.saveRecords([s],{zoneID:{zoneName:"com.apple.coredata.cloudkit.zone"}}).then((function(e){console.log("Successfully saved")})).catch((function(e){var t;console.error(null!==(t=null===e||void 0===e?void 0:e.reason)&&void 0!==t?t:"Unknown error"),C(e).show()}))};var A=function(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),o=document.createElement("h5"),i=document.createElement("button"),r=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div"),l=document.createElement("button"),c=document.createElement("button");return e.id="addTripModal",e.classList.add("modal"),e.classList.add("fade"),e.setAttribute("tabindex","-1"),e.setAttribute("aria-labelledby","label-"+e.id),e.setAttribute("aria-hidden","true"),t.className="modal-dialog",n.className="modal-content",a.className="modal-header",o.id="label-"+e.id,o.className="modal-title",o.innerText="New Trip",i.className="btn-close",i.setAttribute("type","button"),i.setAttribute("data-bs-dismiss","modal"),i.setAttribute("aria-label","Close"),r.className="modal-body",s.id="fromToStations",d.className="modal-footer",l.classList.add("btn"),l.classList.add("btn-secondary"),l.setAttribute("type","button"),l.setAttribute("data-bs-dismiss","modal"),l.textContent="Cancel",c.id="addTripButton",c.classList.add("btn"),c.classList.add("btn-primary"),c.setAttribute("type","button"),c.setAttribute("data-bs-dismiss","modal"),c.toggleAttribute("disabled"),c.onclick=function(){return O()},c.textContent="Add",d.append(l,c),r.append(s),a.append(o,i),n.append(a,r,d),t.append(n),e.append(t),e.addEventListener("hidden.bs.modal",(function(e){var t=document.getElementById("addTripModal");u.a.getInstance(t).dispose(),t.remove()})),new u.a(e)};var I=function(e){return"fromStation"===e?"Origin":"Destination"};var S=function(e){return Object(s.jsx)("option",{id:e.fields.id.value,stopid:e.fields.stopId.value,value:e.fields.name.value},e.recordName)};var D=function(e,t){var n=e.map((function(e){return S(e)}));return Object(s.jsx)("datalist",{id:t+"Options",children:n},t+"OptionsKey")};var T=function(){var e=document.getElementById("addTripButton"),t=document.getElementById("fromStationDataList"),n=document.getElementById("toStationDataList"),a=document.getElementById("fromStationOptions"),o=document.getElementById("toStationOptions"),i=Array.from(a.getElementsByTagName("option")),r=Array.from(o.getElementsByTagName("option")),s=document.getElementById("tripsList"),d=Array.from(s.getElementsByTagName("li")),l=i.map((function(e){return e.getAttribute("value")})),c=r.map((function(e){return e.getAttribute("value")})),u=d.map((function(e){return e.innerText}));l.includes(t.value)&&c.includes(n.value)&&t.value!==n.value&&!u.includes(t.value.split(" Station").join("")+" to "+n.value.split(" Station").join(""))?e.removeAttribute("disabled"):e.setAttribute("disabled","")};var B=function(e,t){var n=Object(s.jsx)("label",{htmlFor:t+"DataList",className:"form-label",children:I(t)},t+"LabelKey"),a=Object(s.jsx)("input",{className:"form-control",list:t+"Options",id:t+"DataList",placeholder:"Type to search...",onInput:function(){return T()}},t+"InputKey");return Object(s.jsx)("div",{id:t,children:[n,a,D(e,t)]},t+"WrapperKey")};var w=function(e){var t=Object(s.jsx)("form",{id:"fromToStationsForm",children:[B(e,"fromStation"),B(e,"toStation")]},"fromToStationsFormKey");r.a.render(t,document.getElementById("fromToStations"))};var L=function(){h.getDefaultContainer().publicCloudDatabase.performQuery({recordType:"Stations",sortBy:[{fieldName:"name",ascending:!0}]},{resultsLimit:200,numbersAsStrings:!1}).then((function(e){if(e.hasErrors)throw e.errors[0];w(e.records)})).catch((function(e){var t;console.error(null!==(t=null===e||void 0===e?void 0:e.reason)&&void 0!==t?t:"Unknown error")}))};var k=function(){A().show(),L()};var _=function(){r.a.unmountComponentAtNode(document.getElementById("trips")),E()};var K=function(e){if(e){var t=Object(s.jsx)("button",{className:"btn btn-primary col-1",type:"button",onClick:function(){return k()},children:"Add"},"addButtonKey"),n=Object(s.jsx)("button",{className:"btn btn-secondary col-1",type:"button",onClick:function(){return _()},children:"Refresh"},"refreshButtonKey"),a=Object(s.jsx)("input",{id:"tripsSearch",className:"form-control col",onKeyUp:function(){return j()},type:"text",placeholder:"Search Trips"},"searchKey"),o=Object(s.jsx)("div",{className:"row m-2 gap-2",children:[a,n,t]});r.a.render(o,document.getElementById("searchBar"))}else r.a.unmountComponentAtNode(document.getElementById("searchBar"))};function R(e){var t;if("string"===typeof e)t=e;else{var n=e.nameComponents;t=n?n.givenName+" "+n.familyName:"User record name: "+e.userRecordName}var a=Object(s.jsx)("span",{className:"navbar-text px-2",children:t});r.a.render(a,document.getElementById("username"))}r.a.render(Object(s.jsx)(o.a.StrictMode,{children:Object(s.jsx)(c,{})}),document.getElementById("root")),function(){var e=h.getDefaultContainer();function t(t){R(t),function(){var e=h.getDefaultContainer();function t(e){v(e).show()}e.addNotificationListener(t),e.registerForNotifications().then((function(e){e.isRegisteredForNotifications&&console.log("Notification registration successful")})).catch((function(e){var t;console.error(null!==(t=null===e||void 0===e?void 0:e.reason)&&void 0!==t?t:"Unknown error registering for notifications"),b(e).show()}))}(),E(),e.whenUserSignsOut().then(n)}function n(a){a&&"AUTH_PERSIST_ERROR"===a.ckErrorCode&&b(a).show(),R("Unauthenticated User"),K(!1),r.a.unmountComponentAtNode(document.getElementById("trips")),e.whenUserSignsIn().then(t).catch(n)}e.setUpAuth().then((function(e){e?(console.log("Authentication successful"),t(e)):n()})).catch((function(e){var t;console.error(null!==(t=null===e||void 0===e?void 0:e.reason)&&void 0!==t?t:"Unknown error setting up authentication"),b(e).show()}))}()}},[[212,1,2]]]);
//# sourceMappingURL=main.4fa53f79.chunk.js.map