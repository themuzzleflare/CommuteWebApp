(this.webpackJsonpcommute=this.webpackJsonpcommute||[]).push([[0],{119:function(e,t){},121:function(e,t){},131:function(e,t){},133:function(e,t){},160:function(e,t){},161:function(e,t){},166:function(e,t){},168:function(e,t){},175:function(e,t){},194:function(e,t){},211:function(e,t,n){"use strict";n.r(t);var a=n(15),o=n.n(a),i=n(7),s=n.n(i),r=(n(28),n(0));var d=function(){return Object(r.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:Object(r.jsxs)("div",{className:"container-fluid",children:[Object(r.jsxs)("a",{className:"navbar-brand hstack gap-2",href:"index.html",children:[Object(r.jsx)("img",{className:"d-inline-block align-text-center rounded-3",alt:"Commute",width:"50",height:"50",src:"images/logo.png"}),"Commute"]}),Object(r.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarContent","aria-controls":"navbarContent","aria-expanded":"false","aria-label":"Toggle Navigation",children:Object(r.jsx)("span",{className:"navbar-toggler-icon"})}),Object(r.jsxs)("div",{id:"navbarContent",className:"collapse navbar-collapse",children:[Object(r.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsx)("a",{className:"nav-link active","aria-current":"page",href:"index.html",children:"Trips"})}),Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsx)("a",{className:"nav-link",href:"stations.html",children:"Stations"})}),Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsx)("a",{className:"nav-link",href:"tools.html",children:"Tools"})}),Object(r.jsx)("li",{className:"nav-item",children:Object(r.jsx)("a",{className:"nav-link",href:"about.html",children:"About"})})]}),Object(r.jsxs)("div",{className:"d-flex",children:[Object(r.jsx)("div",{id:"apple-sign-in-button"}),Object(r.jsx)("div",{id:"apple-sign-out-button"})]}),Object(r.jsx)("div",{id:"username"})]})]})})};var l=function(){return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{id:"alertPlaceholder"}),Object(r.jsx)("div",{id:"searchBar"}),Object(r.jsx)("div",{id:"trips"}),Object(r.jsx)("div",{id:"spinner"}),Object(r.jsx)("div",{id:"toastPlaceholder",className:"position-absolute bottom-0 end-0 p-3"})]})};var c=function(){return Object(r.jsxs)("div",{children:[Object(r.jsx)(d,{}),Object(r.jsx)(l,{})]})},u=n(109),m=n(16),b=n(215);s.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(c,{})}),document.getElementById("root"));var p={containers:[{containerIdentifier:"iCloud.cloud.tavitian.commute",environment:"production",apnsEnvironment:"production",apiTokenAuth:{apiToken:"4ff6e686d07f5c352890701bcff389ed23a506ddfc27a57b8cb8118f16f82ba4",persist:!0,signInButton:{id:"apple-sign-in-button",theme:"white-with-outline"},signOutButton:{id:"apple-sign-out-button",theme:"white-with-outline"}}}],services:{logger:console}},v=u.configure(p);function f(e){var t;if("string"===typeof e)t=e;else{var n=e.nameComponents;t=n?n.givenName+" "+n.familyName:"User record name: "+e.userRecordName}var a=Object(r.jsx)("span",{className:"navbar-text px-2",children:t});s.a.render(a,document.getElementById("username"))}function h(){var e=v.getDefaultContainer().privateCloudDatabase;y(!0),N(!1);e.performQuery({recordType:"CD_Trip",sortBy:[{fieldName:"CD_dateAdded",ascending:!1},{fieldName:"CD_fromName",ascending:!0},{fieldName:"CD_toName",ascending:!0}]},{zoneID:{zoneName:"com.apple.coredata.cloudkit.zone"},resultsLimit:200,desiredKeys:["CD_id","CD_fromId","CD_fromStopId","CD_fromName","CD_toId","CD_toStopId","CD_toName","CD_dateAdded"],numbersAsStrings:!1}).then((function(e){if(e.hasErrors)throw e.errors[0];!function(e){var t=e.map((function(e){return function(e){var t=e.fields,n=t.CD_fromName.value.split(" Station").join("")+" to "+t.CD_toName.value.split(" Station").join("");return Object(r.jsx)("li",{id:t.CD_id.value,className:"list-group-item",children:n},e.recordName)}(e)})),n=Object(r.jsx)("ul",{id:"tripsList",className:"list-group list-group-flush",children:t});s.a.render(n,document.getElementById("trips"))}(e.records),y(!1),N(!0)})).catch((function(e){y(!1),N(!1),function(e){var t,n,a,o=Object(r.jsx)("button",{className:"btn-close",type:"button","data-bs-dismiss":"alert","aria-label":"Close"},"closeButtonKey"),i=null!==(t=null!==(n=null===e||void 0===e?void 0:e.reason)&&void 0!==n?n:null===e||void 0===e?void 0:e.message)&&void 0!==t?t:"An unknown error occurred.",d=Object(r.jsx)("p",{className:"mb-0",children:i},"messageKey"),l=Object(r.jsx)("h5",{className:"alert-heading",children:null!==(a=null===e||void 0===e?void 0:e.ckErrorCode)&&void 0!==a?a:"Error"},"headingKey"),c=Object(r.jsx)("div",{className:"alert alert-danger alert-dismissible fade show m-2",role:"alert",children:[l,d,o]});s.a.render(c,document.getElementById("alertPlaceholder"))}(e),E(e).show()}))}function j(){v.getDefaultContainer().publicCloudDatabase.performQuery({recordType:"Stations",sortBy:[{fieldName:"name",ascending:!0}]},{resultsLimit:200,numbersAsStrings:!1}).then((function(e){if(e.hasErrors)throw e.errors[0];!function(e){function t(t){var a=Object(r.jsx)("label",{htmlFor:t+"DataList",className:"form-label",children:n(t)},t+"LabelKey"),o=Object(r.jsx)("input",{className:"form-control",list:t+"Options",id:t+"DataList",placeholder:"Type to search...",onInput:function(){return function(){var e=document.getElementById("addTripButton"),t=document.getElementById("fromStationDataList"),n=document.getElementById("toStationDataList"),a=document.getElementById("fromStationOptions"),o=document.getElementById("toStationOptions"),i=Array.from(a.getElementsByTagName("option")),s=Array.from(o.getElementsByTagName("option")),r=document.getElementById("tripsList"),d=Array.from(r.getElementsByTagName("li")),l=i.map((function(e){return e.getAttribute("value")})),c=s.map((function(e){return e.getAttribute("value")})),u=d.map((function(e){return e.textContent}));l.includes(t.value)&&c.includes(n.value)&&t.value!==n.value&&!u.includes(t.value.split(" Station").join("")+" to "+n.value.split(" Station").join(""))?e.removeAttribute("disabled"):e.setAttribute("disabled","")}()}},t+"InputKey");return Object(r.jsx)("div",{id:t,children:[a,o,g(e,t)]},t+"WrapperKey")}function n(e){return"fromStation"===e?"Origin":"Destination"}var a=Object(r.jsx)("form",{id:"fromToStationsForm",children:[t("fromStation"),t("toStation")]},"fromToStationsFormKey");s.a.render(a,document.getElementById("fromToStations"))}(e.records)})).catch((function(e){var t;console.error(null!==(t=null===e||void 0===e?void 0:e.reason)&&void 0!==t?t:"Unknown error")}))}function g(e,t){var n=e.map((function(e){return function(e){var t=e.fields;return Object(r.jsx)("option",{id:t.id.value,stopid:t.stopId.value,value:t.name.value},e.recordName)}(e)}));return Object(r.jsx)("datalist",{id:t+"Options",children:n},t+"OptionsKey")}function y(e){if(e){var t=Object(r.jsx)("span",{className:"visually-hidden",children:"Loading..."}),n=Object(r.jsx)("div",{className:"spinner-border m-5",role:"status",children:t}),a=Object(r.jsx)("div",{className:"d-flex justify-content-center",children:n});s.a.render(a,document.getElementById("spinner"))}else s.a.unmountComponentAtNode(document.getElementById("spinner"))}function N(e){if(e){var t=Object(r.jsx)("button",{className:"btn btn-primary col-1",type:"button",onClick:function(){return function(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),o=document.createElement("h5"),i=document.createElement("button"),s=document.createElement("div"),r=document.createElement("div"),d=document.createElement("div"),l=document.createElement("button"),c=document.createElement("button");return e.id="addTripModal",e.classList.add("modal"),e.classList.add("fade"),e.setAttribute("tabindex","-1"),e.setAttribute("aria-labelledby","label-"+e.id),e.setAttribute("aria-hidden","true"),t.className="modal-dialog",n.className="modal-content",a.className="modal-header",o.id="label-"+e.id,o.className="modal-title",o.innerText="New Trip",i.className="btn-close",i.setAttribute("type","button"),i.setAttribute("data-bs-dismiss","modal"),i.setAttribute("aria-label","Close"),s.className="modal-body",r.id="fromToStations",d.className="modal-footer",l.classList.add("btn"),l.classList.add("btn-secondary"),l.setAttribute("type","button"),l.setAttribute("data-bs-dismiss","modal"),l.textContent="Cancel",c.id="addTripButton",c.classList.add("btn"),c.classList.add("btn-primary"),c.setAttribute("type","button"),c.setAttribute("data-bs-dismiss","modal"),c.toggleAttribute("disabled"),c.onclick=function(){return function(){var e=v.getDefaultContainer().privateCloudDatabase,t=document.getElementById("fromStationDataList"),n=document.getElementById("toStationDataList"),a="div[id='fromStation'] datalist[id='fromStationOptions'] option[value='"+t.value+"']",o="div[id='toStation'] datalist[id='toStationOptions'] option[value='"+n.value+"']",i=document.querySelector(a),s=document.querySelector(o),r={recordType:"CD_Trip",fields:{CD_entityName:{type:"STRING",value:"Trip"},CD_id:{type:"STRING",value:Object(b.a)().toUpperCase()},CD_fromId:{type:"STRING",value:i.id},CD_fromStopId:{type:"STRING",value:i.getAttribute("stopid")},CD_fromName:{type:"STRING",value:i.getAttribute("value")},CD_toId:{type:"STRING",value:s.id},CD_toStopId:{type:"STRING",value:s.getAttribute("stopid")},CD_toName:{type:"STRING",value:s.getAttribute("value")},CD_dateAdded:{type:"TIMESTAMP",value:Date.now()}}},d={zoneID:{zoneName:"com.apple.coredata.cloudkit.zone"}};e.saveRecords([r],d).then((function(e){})).catch((function(e){var t;console.error(null!==(t=null===e||void 0===e?void 0:e.reason)&&void 0!==t?t:"Unknown error"),E(e).show()}))}()},c.textContent="Add",d.append(l,c),s.append(r),a.append(o,i),n.append(a,s,d),t.append(n),e.append(t),e.addEventListener("hidden.bs.modal",(function(e){var t=document.getElementById("addTripModal");m.a.getInstance(t).dispose(),t.remove()})),new m.a(e)}().show(),void j()},children:"Add"},"addButtonKey"),n=Object(r.jsx)("button",{className:"btn btn-secondary col-1",type:"button",onClick:function(){return x(),void h()},children:"Refresh"},"refreshButtonKey"),a=Object(r.jsx)("input",{id:"tripsSearch",className:"form-control col",onKeyUp:function(){return function(){var e,t=document.getElementById("tripsSearch").value.toUpperCase(),n=document.getElementById("tripsList").getElementsByTagName("li");for(e=0;e<n.length;e++)(n[e].textContent||n[e].innerText).toUpperCase().indexOf(t)>-1?n[e].style.display="":n[e].style.display="none"}()},type:"text",placeholder:"Search Trips"},"searchKey"),o=Object(r.jsx)("div",{className:"row m-2 gap-2",children:[a,n,t]});s.a.render(o,document.getElementById("searchBar"))}else s.a.unmountComponentAtNode(document.getElementById("searchBar"))}function x(){s.a.unmountComponentAtNode(document.getElementById("trips"))}function E(e){var t,n,a,o,i=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),d=document.createElement("div"),l=document.createElement("h5"),c=document.createElement("button"),u=document.createElement("div"),p=document.createElement("p"),v=document.createElement("div"),f=document.createElement("button"),j=document.createElement("button");return i.id=null!==(t=null===e||void 0===e?void 0:e.uuid)&&void 0!==t?t:Object(b.a)(),i.classList.add("modal"),i.classList.add("fade"),i.setAttribute("tabindex","-1"),i.setAttribute("aria-labelledby","label-"+i.id),i.setAttribute("aria-hidden","true"),s.className="modal-dialog",r.className="modal-content",d.className="modal-header",l.id="label-"+i.id,l.className="modal-title",l.innerText=null!==(n=null===e||void 0===e?void 0:e.ckErrorCode)&&void 0!==n?n:"Error",c.className="btn-close",c.setAttribute("type","button"),c.setAttribute("data-bs-dismiss","modal"),c.setAttribute("aria-label","Close"),u.className="modal-body",p.innerText=null!==(a=null!==(o=null===e||void 0===e?void 0:e.reason)&&void 0!==o?o:null===e||void 0===e?void 0:e.message)&&void 0!==a?a:"An unknown error occured.",v.className="modal-footer",f.classList.add("btn"),f.classList.add("btn-secondary"),f.setAttribute("type","button"),f.setAttribute("data-bs-dismiss","modal"),f.textContent="Close",j.classList.add("btn"),j.classList.add("btn-primary"),j.setAttribute("type","button"),j.setAttribute("data-bs-dismiss","modal"),j.onclick=function(){return h()},j.textContent="Retry",v.append(f,j),u.append(p),d.append(l,c),r.append(d,u,v),s.append(r),i.append(s),new m.a(i)}function C(e){var t,n,a,o,i=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),d=document.createElement("div"),l=document.createElement("h5"),c=document.createElement("button"),u=document.createElement("div"),p=document.createElement("p"),v=document.createElement("div"),f=document.createElement("button");return i.id=null!==(t=null===e||void 0===e?void 0:e.uuid)&&void 0!==t?t:Object(b.a)(),i.classList.add("modal"),i.classList.add("fade"),i.setAttribute("tabindex","-1"),i.setAttribute("aria-labelledby","label-"+i.id),i.setAttribute("aria-hidden","true"),s.className="modal-dialog",r.className="modal-content",d.className="modal-header",l.id="label-"+i.id,l.className="modal-title",l.innerText=null!==(n=null===e||void 0===e?void 0:e.ckErrorCode)&&void 0!==n?n:"Error",c.className="btn-close",c.setAttribute("type","button"),c.setAttribute("data-bs-dismiss","modal"),c.setAttribute("aria-label","Close"),u.className="modal-body",p.innerText=null!==(a=null!==(o=null===e||void 0===e?void 0:e.reason)&&void 0!==o?o:null===e||void 0===e?void 0:e.message)&&void 0!==a?a:"An unknown error occurred.",v.className="modal-footer",f.classList.add("btn"),f.classList.add("btn-secondary"),f.setAttribute("type","button"),f.setAttribute("data-bs-dismiss","modal"),f.textContent="Close",v.append(f),u.append(p),d.append(l,c),r.append(d,u,v),s.append(r),i.append(s),new m.a(i)}!function(){var e=v.getDefaultContainer();function t(t){f(t),function(){var e=v.getDefaultContainer();function t(e){(function(e){var t=Object(r.jsx)("div",{className:"toast-body",children:"A change has been made to your saved trips from another device. Please refresh."},e.notificationID+"-bodyKey"),n=Object(r.jsx)("strong",{className:"me-auto",children:"Change made to Trips"},e.notificationID+"-titleKey"),a=Object(r.jsx)("button",{className:"btn-close",type:"button","data-bs-dismiss":"toast","aria-label":"Close"},e.notificationID+"-closeButtonKey"),o=Object(r.jsx)("div",{className:"toast-header",children:[n,a]},e.notificationID+"-headerKey"),i=Object(r.jsx)("div",{id:"tripsChangeNotification",className:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true",children:[o,t]});s.a.render(i,document.getElementById("toastPlaceholder"));var d=document.getElementById("tripsChangeNotification");return d.addEventListener("hidden.bs.toast",(function(){s.a.unmountComponentAtNode(document.getElementById("toastPlaceholder"))})),new m.b(d)})(e).show()}e.addNotificationListener(t),e.registerForNotifications().then((function(e){e.isRegisteredForNotifications&&console.log("Notification registration successful")})).catch((function(e){var t;console.error(null!==(t=null===e||void 0===e?void 0:e.reason)&&void 0!==t?t:"Unknown error registering for notifications"),C(e).show()}))}(),h(),e.whenUserSignsOut().then(n)}function n(a){a&&"AUTH_PERSIST_ERROR"===a.ckErrorCode&&C(a).show(),f("Unauthenticated User"),N(!1),x(),e.whenUserSignsIn().then(t).catch(n)}e.setUpAuth().then((function(e){e?(console.log("Authentication successful"),t(e)):n()})).catch((function(e){var t;console.error(null!==(t=null===e||void 0===e?void 0:e.reason)&&void 0!==t?t:"Unknown error setting up authentication"),C(e).show()}))}()}},[[211,1,2]]]);
//# sourceMappingURL=main.c7879fcc.chunk.js.map